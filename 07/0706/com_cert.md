# 전자계산기조직응용기사-어셈블리어

## 어셈블리어
니모닉 코드(어셈블리어)로 작성해 어셈블러에 의해 해석된다. 
CPU마다 코드가 다르다. 코딩 및 디버깅이 어렵지만 프로그램 실행 속도는 가장 빠르다. 
기계어와 1:1 대응되는 코드이다. 
라벨 필드(레이블), 명령어 필드, 코멘트 필드(주석) 세 가지 필드로 나뉘어 작성된다. 
MRI(Memory Reference Instruction), 레지스터 참조 명령어(non-MRI), 의사명령어(Pseudo Instruction)으로 명령어를 구분한다.   
ex) GET\_COUNT: MOV CX, DI; Initialize count  
위 명령어 라인에 레이블, 명령어, 주석이 다 있다.  
  
## 레지스터
CPU 내부의 저장공간이다. 
세그먼트 레지스터, 인덱스 레지스터, 플래그(상태) 레지스터, 범용 레지스터가 있다. 
시험에는 범용 레지스터(AX, BX, CX, DX)만 나온다. 
  
## 의사명령어
원시프로그램을 번역할 때 어셈블러에게 요구되는 동작을 지시하는 명령이다. 기계어로 번역되지 않는다. 
INCLUDE, USING, DROP, MACRO, ENDM(MEND), ASSUME, BYTE PTR 등이 있다. 

## 일반 명령어
EQU, MOV, XCHG 정도가 자주 나온다. ADC, TEST, MOD, TITLE, PUBLIC, EJECT까지 알아두면 좋다. 
실제 어셈블리 명령어도 처음부터 전부 외워서 쓴다기 보다는 필요할 때마다 메뉴얼에서 찾아 쓰기 때문에 
위 명령어 정도만 외워두자. 관계 연산자는 LT, GT, LE, GE, EQ, NE로 표현한다. 

## 문자열 관련 명령어
CMPS, LODSB, REPE, MOVS, SCAS 약어임을 기억하자.

## 입출력 및 인터럽트 관련 명령어
INT, IRET, CALL, RET, POP, PUSH, JMP, LOOP

## 주소지정방식
즉치 어드레싱 모드(Immediate address mode -> MOV a, 55), 레지스터 어드레싱 모드(mov ax, bx), 
직접 어드레싱 모드(mov value, 55), 간접 메모리 어드레싱 모드(C언어 포인터처럼 주소를 참조해서 값을 참조 mov a, [b]). 
대괄호 안에 있으면 주소 참조이다. 

## 어셈블러
어셈블리어를 기계어로 번역해주는 언어 번역기이다. 
First Pass에는 코드 전체를 스캔해 '주소-기호 테이블'을 생성한다. 
Second Padd에는 Table-lookup을 사용해 번역한다. 슈도 명령어 테이블, MRI 테이블, Non-MRI 테이블, 주소-기호 테이블 등으로 테이블을 나눠 번역하는 방식이다. 

## 레지스터
CPU가 요청을 처리하는 데 필요한 데이터를 일시적으로 저장하는 장치이다. 범용 레지스터, 플래그(컨트롤) 레지스터, 세그먼트 레지스터로 구분된다. 
  
1. 범용 레지스터  
데이터 레지스터- 산술, 논리연산과 관련 작업 (AX-입출력+산술, BX(Base Register)-주소 연산, CX- 루프 횟수 제어와 시프트연산, DX-AX와 비슷)  
포인터 레지스터- 명령어, 스택을 가리킨다. (BP- 함수에서 관리하는 스택 영역의 시작주소 지정, IP- 실행되는 다음 명령어의 주소 저장(위치 계수기, 명령 계수기라고도 한다.), SP(스택 포인터))  
인덱스 레지스터- 인덱스 주소지정과 주소 연산에 사용한다. (SI(Source Index) - 문자열 처리를 위한 소스 인덱스), DI- 문자열 처리를 위한 목적지 인덱스  
  
2. 플래그 레지스터(컨트롤 레지스터)  
어셈블러에 의해 수행된 명령어 결과와 CPU 상태에 대한 결과를 저장한다.  
IF(Interrupt Flag) - 인터럽트 허용(0 무시, 1 허용) 여부 체크, ZF(Zero Flag) - 산술, 논리 연산 결과값이 0일때 1로 설정되는 플래그, CF(Carry Flag) 덧셈 연산 후 자리올림이 있을 경우 1로 설정되는 플래그  
  
3. 세그먼트 레지스터  
세그먼트 주소에 액세스하기 위한 레지스터이다.  
CS - 코드 세그먼트(프로그램의 명령어 저장)의 시작 번지를 저장  
DS - 데이터 세그먼트(변수, 상수 저장)의 ~  
SS - 스택 세그먼트의 ~  
EX - Extra Segment Register 보조용  

## 기능에 따른 어셈블리 명령어 종류

1. 산술 명령어 - INC, DEC, NOT, NEG(오퍼랜드의 2의 보수 계산 - 부호 반전), MOD, MOD를 제외하면 모두 단항 연산자이다.  
2. 제어 명령어 - TEST(AND 이항 연산 후 값을 플래그로 세팅), CMP, JMP(GOTO), JE(if a==b -> GOTO), JZ(Jump on Zero), LOOP(CX 레지스터가 0보다 크면 -- 루프), LOOPE(ZERO 플래그가 1이고, CX레지스터가 0보다 크면 -- 루프), CALL(서브루틴 호출), RET(Return from CALL) 서브 루틴을 자신을 호출한 곳으로 복귀시킨다.  
3. 데이터 전송 명령어 - MOV(MOV A, B == (A=B)), XCHG(오퍼랜드 교환), LEA(Load Effective Address to Register) - 두 번째 오퍼랜드 주소를 첫 번째 오퍼랜드에 대입  
4. 변환 명령어 - CBW(Convert Byte to Word), CWD(Word to Double Word), CDQ(Double Word to Quad Word), CVD(2, 16진수 표현을 10진수 변환)  
5. 스택 명령어 - PUSH, POP  
6. 프로세스 제어 명령어 - HLT(Halt - 프로세스 종료), LOCK(Bus Lock Prefix) - 다음 명령 수행 전까지 다른 프로세서 접근 막음, WAIT(프로세스 일시정지)  
7. ⭐️문자열 처리 명령어⭐️ - REP(명령어 반복수행 지시), MOVS(문자열 카피), CMPS(strcmp), SCAS(레지스터에 있는 문자열과 메모리에 있는 문자열 비교), STOS(레지스터에 있는 문자열 메모리에 저장), LODS(메모리에 있는 문자열 레지스터로 가져오기)  
  
## 입출력 및 인터럽트
1. 입출력명령  
TITLE - 해당 내용을 페이지 상단에 출력, PAGE - 리스트의 형식 결정, EJECT - 리스트 출력시 해당 명령 위치에서 페이지를 바꿔 다음 내용 출력  
  
2. 인터럽트 명령  
CPU가 프로그램을 실행 중일 때 출력 하드웨어에 문제가 생기면 예외상황을 CPU에 알려 처리하도록 하는 기능이다.  
INT - 하나의 오퍼랜드에 호출할 벡터의 번호를 표현해 가로채기를 요청하는 명령  
INTO - 오버플로우가 발생하면 인터럽트 실행  
IRET - Interrupt Service Routine으로부터 복귀 명령에 해당하는 명령  

