<h1> 과목1 - 1. 데이터 모델링의 이해</h1> (5/8,5/9,5/14 -ing)

## 1절. 데이터 모델의 이해

#### 데이터 모델링의 중요성
파급효과 - 전체 시스템에서 데이터 모델의 변경이 가져올 파급효과에 대해 생각해야 한다.  
간결한 표현 - 데이터 모델은 실재의 간결한 표현이다. 목적에 따라 실재의 복잡성을 간결히 표현해야 한다.  
데이터 품질 - 데이터 품질은 곧 기업의 자산이다.  

데이터 모델링은 중복, 비유연성, 비일관성을 피해야 한다.  

#### 데이터 모델링 3단계
개념 데이터 모델링(계획 or 분석 단계) - ER 다이어그램 산출  
논리 데이터 모델링(분석 단계) - 정규화, M:M 관계 해소, 식별자 확정, 참조 무결성 규칙 정의  
물리 데이터 모델링(설계 단계) - 물리적 저장 구조(테이블, 스키마), 하드웨어, 자료 추출을 위한 접근 방법   

폭포수 모델 -> 분석(개념, 논리) - 설계(물리데이터 모델링) - 개발(구축) - 테스트(튜닝) - 전환,이행

#### 데이터 독립성 모델 3단계
외부 단계(-> 논리적 데이터 독립성)  
개념적 단계(-> 물리적 데이터 독립성)  
내부적 단계  
  
#### 데이터 독립성 구성 요소
외부 스키마 - 유저, 개발자 등 사용자 관점의 스키마  
개념 스키마 - 개념적 단계의 단 하나의 스키마. 통합 관점에서 전체 DB를 기술한 것  
내부 스키마 - 내부적 단계와 내부 스키마로 구성된다. DB가 물리적으로 저장된 형식

논리적 독립성 - 개념 스키마가 변경되어도 외부 스키마에는 영향이 없도록 하는 독립성. 응용 프로그램에 영향을 미치지 않는다.  
물리적 독립성 - 내부 스키마가 변경되어도 외부, 개념 스미카는 영향을 받지 않도록 하는 것. 저장 장치의 변경은 스키마와 관련없다.  
-> 개념 스키마는 사용 애플리케이션이나 하드웨어와 독립적이어야 하고 하드웨어도 애플리케이션과 DB에 독립적이어야 한다.  

#### 데이터 모델링의 세 가지 요소
반드시 기억할 개념 세 가지(데이터 모델 이해의 근간)
1. Things - 업무가 관여하는 '무엇' -> 엔터티, 엔터티 타입, 인스턴스, 어커런스(Occurrence)  
2. Attributes - '무엇'의 성격  -> 속성, 속성 값  
3. Relationships - '무엇'간의 관계 -> 관계, 페어링  

#### E-R 다이어그램
엔터티는 사각형 관계는 마름모꼴로 설명하는 모형은 첸 모델로 실무에서는 거의 쓰이지 않는다.  
SQLD는 실무에서 많이 쓰는 IE(Information Engineering)표기법과 바커 표기법을 설명한다.  
IE/Crow's Foot, CaseMethod/Barker 표기법 둘 다 까마귀 발을 쓴다.  
  
모델링 순서  
엔터티 그리기 -> 배치(왼-오) -> 관계설정(선긋기) -> 관계명 기술 -> 관계별 참여도 기술 -> 관계 필수여부 기술  
  
배치  
가장 중요한 건 왼쪽 상단에서 조금 아래쪽 중앙, 중요도 순으로 왼쪽에서 오른쪽으로 하면 시선이 꼬이지 않는다.  
  
관계설정(선긋기) - 기본키 외래키 관계로 선긋기, 중복 안 됨, Circle 관계도 안 됨    
  
관계명은 엔터티 성질과 주식별자를 보고 구분됨으로 안 써도 된다.  

#### 좋은 데이터 모델의 요소
객관적인 기준은 없지만 핵심적 요소는 있다.  
완중없  
완전성 - 업무에 필요한 데이터가 완전히 데이터 모델에 정의되어 있어야 한다.  
중복 배제 - Non-Redundancy 하나의 DB에 동일한 사실은 오직 한 번만 기록돼야 한다.  
업무 규칙 - 데이터 조작에 대한 기준이 설 수 있도록 데이터 모델을 활용하는 업무 규칙을 포함해야 한다.  
데이터 재사용 - 합리적인 관계 설정과 테이블 구분으로 재사용성을 높여야 한다.  
의사소통 - 데이터 모델 직급/업무 등의 특성을 반영해 의사소통의 도구로서 기능해야 한다.  
통합성 - 한 번 정의되고 여러 곳에서 참조-활용된다.  

## 2절 엔터티
엔터티란? 데이터 베이스에서 변별 가능한 객체집합이다.  
인스턴스란? 엔터티의 개별적 요소이다.  

#### 엔터티의 조건
1. 업무에 필요해야 한다.  
2. 유일한 식별자에 의해 식별되어야 한다.  
3. 인스턴스의 집합이다.  
4. 업무 프로세스에서 이용되어야 한다.  
5. 반드시 속성을 포함한다.(예외적으로 관계 엔터티는 주식별자 속성만 가지고 있어도 엔터티로 인정)  
6. 다른 엔터티와 최소 한 개 이상의 관계를 가진다.  
  
#### 엔터티의 분류
실체 유형에 따른 분류와 시간에 따른 분류가 있다.  
  
유무형에 따른 분류  
유형, 개념(무형), 사건(액션)  
  
발생시점에 따른 분류  
기본엔터티(도메인 핵심, 모든 엔터티의 부모 엔터티)  
중심엔터티(기본 엔터티로부터 파생, 데이터량 많음, 업무의 중심적 역할 수행, 행위엔터티를 생성)  
행위엔터티(두 개 이상의 부모엔터티로부터 발생, 자주 갱신됨)
   
#### 엔터티의 명명 
1. 가능하면 현업 용어 그대로
2. 약어 쓰지마라
3. 단수형 명사 사용
4. 모든 엔터티는 유일한 이름으로  
5. 엔터티 생성 의미대로 이름을 부여  

## 3절 속성
DB의 속성은 업무에서 관리하고자 하는 의미의 최소 단위이다.  
IE 표기법과 바커 표기법이 있다.  

#### 속성의 특징
만약 속성의 특징이 다음 성질을 만족하지 못하면 적절하지 않을 확률이 높다.  
1. 엔터티와 마찬가지로 반드시 해당 업무에 필요하고 관리하고자 하는 정보여야 한다.  
2. 정규화 이론에 근거해 정해진 주식별자에 함수적 종속성을 가져야 한다.  
3. 하나의 속성은 한 개의 값만을 가진다. 하나의 속성에 여러 값이 있는 다중값의 경우 별도의 엔터티를 이용해 분리한다.  
  
#### 속성의 분류
속성의 특징에 따른 분류  
1. 기본속성 - 엔터티에서 가장 많은 속성. 업무로부터 추출한 모든 속성을 말한다. 코드, 일련번호, 다른 속성을 계산하거나 다른 속성에 영향을 받은 속성을 제외한 모든 속성이 기본속성이다.  
2. 설계속성 - 업무상 필요한 데이터 외에 업무를 규칙화하거나 필요에 따라 변형해 만든 속성.  
3. 파생속성 - 타 속성에 영향을 받아 발생하는 속성. 계산된 값들이 해당한다. 가능한한 적게 정의하는 게 좋다.(데이터 정합성 위해)  
파생속성은 될 수 있으면 꼭 필요한 경우만 정의해 업무 로직이 속성 내부에 숨지 않게 해야한다.  
  
엔터티 구성 방식에 따른 분류  
1. PK(Primary Key) 속성 - 엔터티를 식별할 수 있는 속성  
2. FK(Foreign Key) 속성 - 다른 엔터티와의 관계에서 포함된 속성  
3. 일반 속성 - 엔터티에 포함되어 있고 PK/FK에 포함되지 않은 속성  
  
## 4절 관계
존재적 관계와 행위적 관계로 나뉜다. 엔터티의 인스턴스들은 자신이 관련된 인스턴스들과 관계의 어커런스로 참여하는 형태를 관계 페어링이라 한다.  
관계 패어링이 항상 양방향으로 일치하는 것은 아니다.(ex. 강사 ->{강의한다}-> 학생, 학생 ->{배운다}-> 강사)  

#### 관계의 분류
존재에 의한 관계와 행위에 의한 관계로 나뉜다고 했다.  
단순하다. 김경민 사원이 ER컴퍼니의 사원이면 {소속된다.}의 존재적 관계로 항상 ER 컴퍼니에 소속된다.  
반면에 김경민 사원이 새마을 식당의 고객이면 {주문한다.}의 행위적 관계로 주문할 때만 관계가 형성된다.  
따라서 존재적 관계는 항구적(모델 변경이 있기까지)이고 행위적 관계는 일시적이다.  
이런 존재/행위 관계의 차이를 ERD에서는 구분하지 않고 표현한다.  
그러나 UML의 클래스 다이어그램에서는 구분한다.  
클래스 다이어그램에서 연관관계는 항상 이용하는 관계로 존재관계이다. 따라서 실선 화살표로 표시한다.  
반면에 의존관계는 행위에 따라 일시적으로 관계를 맺기에 행위관계이다. 따라서 점선 화살표로 표시한다.  
  
#### 관계의 표기법
관계명(Membership): 관계의 이름(관계명은 한 관계에 두 가지 관점으로 표현된다. 포함한다 <-> 소속된다)  
-> 관계가 시작되는 편을 관계시작점이라고 부르고 받는 편을 관계끝점이라고 부른다.  
관계차수(Cardinality): 1:1, 1:M, M:N   
-> 관계에서 참여자의 수를 표현한다. Crow's Foot 모델에서 하나는 한 줄, 여러개는 까마귀발, 0개는 0을 붙이는 것으로 표현한다.  
관계선택사양(Optionality): 필수관계, 선택관계  
-> 회의보고서가 데이터 베이스에 존재하려면 반드시 회의가 있어야 한다. 이와 같이 회의와 회의보고서는 필수적으로 연결된 관계이다.  
이런 관계를 두고 필수참여관계라고 한다. 반면에 회의와 이사진의 관계는 이사진의 대부분이 회의에 참여하고는 한다는 연관성은 있지만 이사진 모두가 항상 필연적으로 회의에 참여하는 것은 아님으로 필수적 관계가 아닌 선택적 관계가 된다.  
이런 관계는 선택참여관계라고 한다. 선택참여된 항목은 물리 속성에서 외래키로 연결될 경우 NULL을 허용할 수 있게 된다.  
또 ERD에서 관계를 나타내는 선에서 선책참여하는 엔터티 쪽은 원으로 표시한다. 필수참여는 아무 표시를 하지 않는다.  

#### 관계의 정의 및 읽는 방법
- 관계 체크사항  
두 개의 엔터티 사이에서 관계를 정의할 때 다음을 체크해본다.  
-> 두 개의 엔터티 사이에 관심 있는 연관 규칙이 존재하는가?
-> 두 개의 엔터티 사이에 정보의 조합이 발생하는가?
-> 업무기술서, 장표에 관계연결에 대한 규칙이 서술되어 있는가?
-> 업무기술서, 장표에 관계연결을 가능하게 하는 동사(Verb)가 있는가?

- 관계 읽기
관계에 참여하는 기준 엔터티를 하나 또는 각(Each)로 읽고, 대상 엔터티의 개수(하나, 하나 이상)를 읽고 관계선택사양과 관계명을 읽는다.  
각 -> 기준엔터티 -> 관계차수 -> 관련엔터티 -> 선택사양(필수/선택) -> 관계명  
ex1. 각각의 사원은 한 부서에 항상 속한다.  
ex2. 각 부서에는 여러 사원이 때때로 소속된다.  

## 5절 식별자
엔터티는 인스턴스들의 집합이다. 이때 엔터티를 다른 엔터티와 구별할 수 있게 해주는 속성을 식별자라고 한다.  
식별자는 타 엔터티와 구별되어 해당 엔터티를 대표하는 유일한 속성이다. 보통 식별자와 키가 동일시되고는 한다.  
  
#### 주식별자의 특징
1. 유일성 - 주식별자에 의해 엔터티 내의 모든 인스턴스들을 유일하게 구분할 수 있어야 한다. ex) 회원목록 내 중복이 없는 ID  
2. 최소성 - 주식별자를 구성하는 속성의 수는 유일성을 만족하는 최소의 수가 되어야 한다. ex) ID + Password로도 회원을 구분할 수 있지만 Password없이 ID만으로도 회원을 구분할 수 있기에 최소성을 만족하지 않는다. 이 경우 부적절한 주식별자 구조이다.  
3. 불변성 - 주식별자가 한 번 특정 엔터티에 지정되면 그 값은 변하지 않아야 한다. ex) 값이 변한다는 의미는 이전 값을 폐기하고 새 값을 할당한다는 이야기이다.  
4. 존재성 - 주식별자 없는 데이터 값은 없다. NULL은 안 된다.  
  
#### 식별자 분류와 표기법
대표성 여부에 따른 분류 -> 1. 주식별자 2. 보조식별자  
스스로 생성되는지에 따른 분류 -> 1. 내부식별자(엔터티내에서 만들어짐) 2. 외부식별자(타 엔터티와의 관계를 통해 타 엔터티로부터 받아옴)  
속성 수에 따른 분류 -> 1. 단일식별자(하나의 속성으로 구성) 2. 복합식별자(둘 이상의 속성으로 구성)  
대체 여부에 따른 분류 -> 1. 본질식별자(업무에 의해 만들어짐) 2. 인조식별자(업무x 인위적으로 만든 식별자)  
  
식별자 표기법은 문제풀이로 익힌다.  
  
#### 주식별자의 도출기준
1. 해당 업무에서 자주 이용되는 속성을 주식별자로 지정  
2. 명칭, 내역 등과 같이 이름으로 기술되는 것은 피함  
3. 속성의 수가 많아지지 않도록 함  
  
#### 식별자관계와 비식별자관계에 따른 식별자
1. 식별자 관계 - 자식 엔터티가 부모 엔터티의 주식별자를 상속해 사용하는 관계  
2. 비식별자 관계 - 자식 엔터티가 부모 엔터티의 주식별자를 상속받지만 이를 일반적인 속성으로 사용하는 관계이다. 또한 해당 자식 엔터티는 부모엔터티로부터 물려받은 속성을 자신의 자식 엔터티에는 차단한다.   
- 식별자 관계만으로 상속되었을 때 문제점 - 주식별자를 상속받은 자식 엔터티는 부모의 주식별자에 추가적인 주식별자를 더한다. 이런 식으로 상속이 이어지면 뒤로 갈수록 엔터티가 너무 많은 주식별자를 갖게 된다.  
- 비식별자 관계만으로 상속되었을 때 문제점 - 부모엔터티로부터 물려받아 자주 사용하는 속성이 상속을 거치며 차단된다면 단순한 정보를 조회하기 위해 부모 엔터티까지 거슬러 올라가 조인해야할 필요가 생긴다.  


